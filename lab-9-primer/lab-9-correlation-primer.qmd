---
title: "Lab 11 Primer"
format: live-html
execute: 
  warning: false
  echo: true
  message: false
---

```{r echo=FALSE}
library(checkdown)
```


Before you start, add the code that will load any packages you might need into this code chunk. 
```{webr}
library(__stats package__)
library(__graphics package__)
```



## Muscle Mass

A person's muscle mass is expected to decrease with age. To explore this relationship in women, a nutritionist randomly selected 60 women between 40 and 79 years old. The research objective is to see if there is the expected muscle mass (in kilograms; kg) **linear decrease** with respect to age (in years) as an approximate trend. The data are found in the file `MuscleMass.csv`. 
*Data from Applied Linear Statistical Models, Kutner et al 2004, 5th ed.* 

Let's analyze the data using a linear model. We use the following notation for a linear model: 

$$Y_{muscle~mass} = \beta_0 + \beta_1 \cdot X_{age} + \epsilon$$


```{webr}
muscle <- read.csv("MuscleMass.csv", header=TRUE) #reads in the csv file 
names(muscle)
```


1. For each variable, identify whether it is the explanatory or response variable in our analysis, and the type of variable.

Age:

```{r echo=FALSE}
check_question(c("Explanatory","Numeric"), options = c("Explanatory", "Response", "Categorical", "Numeric"), type = "checkbox")
```
<br>

Muscle Mass:

```{r echo=FALSE}
check_question(c("Response","Numeric"), options = c("Explanatory", "Response", "Categorical", "Numeric"), type = "checkbox")
```
<br>


2. Identify the *study type* of this study. Be sure you are able to provide a full justification.  

```{r echo=FALSE}
check_question("Observational", options = c("Experiment", "Observational"), type = "radio")
```
<br>


3. Modify the code below to estimate the population regression line using the data. Then, create a scatterplot of the data, including the estimated linear model on the plot.     

```{webr}
MM.age<-_____(________ ~ ________, data = ________) # create linear model
___graphic___(________ ~ ________, data = ________, # create scatterplot
              ylab="____________________",
              xlab="____________________") |>
  ______(________ ~ ________, data = ________) # add linear model to scatterplot
```


4. Identify the symbolic hypotheses for this study.   

```{r echo=FALSE}
check_question(c("\U03B2 1=0", 
               "\U03B2 1<0"), 
               options = c("\U03B2 0=0",
               "\U03B2 1=0", 
               "\U03B2 1=-1.19",
               "\U03B2 1>0",
               "\U03B2 1<0",
               "\U03B2 1 \U2260 0"),
               type = "checkbox")
```

> Write the hypotheses verbally in context. Bring your answers to office hours or the CLC for review.


5. Conduct the appropriate testing for the assumptions of regression analysis. Modify the code below to create the additional plots needed.  

```{webr}
plot(MM.age, ___, add.smooth = FALSE) # Fitted Values vs. Residuals
plot(MM.age, ___) # QQ plot
plot(MM.age, ___, add.smooth = FALSE) # Cook's Distance
```


Which of the conditions appear to be reasonably met?

```{r echo=FALSE}
check_question(c("Linearity", "Normality of residuals", "Equal variance of residuals", "Independence of Residuals", "No influential points"), 
               options = c("Linearity", 
                           "Normality of residuals", 
                           "Equal variance of residuals", 
                           "Independence of Residuals", 
                           "No influential points"),
               type = "checkbox")
```

> Write justifications for each condition. Bring your answers to office hours or the CLC for review.



6. Modify the code below the create a summary table to assess whether there is a statistically significant relationship between the two variables. Then determine the following statistics for your linear model.  

```{webr}
________(MM.age)
```

Intercept:
```{r echo=FALSE}
check_question(answer = 156.3466, right = "correct", wrong = "not correct")
```

Slope: 
```{r echo=FALSE}
check_question(answer = -1.1900, right = "correct", wrong = "not correct")
```

$R^2$: 
```{r echo=FALSE}
check_question(answer = 0.7501, right = "correct", wrong = "not correct")
```
<br>


7. Arrange the words to interpret the coefficient of determination. $R^2$ is...  

```{r echo=FALSE}
check_question(c("the proportion of variability", 
                 "in muscle mass",
                 "in women aged 40-79 years old",
                 "that is explained",
                 "by the linear model",
                 "with age"), 
               type = "in_order", alignment = "vertical")
```
<br>

<!-- 1.8. Assess the strength of the relationship using the coefficient of determination. Is age a good predictor of muscle mass? -->

<!-- > Insert your answer here. -->


8. Modify the code below to determine the 95% confidence interval for the slope of the regression line.  

```{webr}
_____(MM.age, level=_____)
```

> Be sure you can interpret and evaluate the confidence interval. Bring your answers to office hours or the CLC for review.   


9. Modify the code below to perform a power analysis for your regression model, using an effect size of 0.15 and significance level of 0.05.   

```{webr}
pwr.f2.test(u=_____, v=_____, f2=_____, sig.level=_____, power=_____)
```

> Interpret your power analysis. Bring your answers to office hours or the CLC for review.   


10. Which of the following statements are true?  

```{r echo=FALSE}
check_question(c("The individuals were not randomly assigned to their value of the explanatory variable, so this is not an experiment but an observational study instead, so we can't determine causality", "The individuals were randomly selected, so we can generalize to the population"), 
               options = c(
                 "The individuals were sampled randomly, so it implies an observational study", 
                 "The individuals were not randomly assigned to their value of the explanatory variable, so this is not an experiment but an observational study instead, so we can't determine causality",
                 "The individuals were randomly assigned to the explanatory variable, so this is an experiment, so we can say any changes we observed is due to the explanatory variable",
                 "The individuals were randomly assigned to the explanatory variable, so this is an experiment, but we can only determine an association, not causality",
                 "The individuals were randomly assigned to their value of the explanatory variable, but we cannot generalize to all individuals in the population since there was not also a random selection",
                 "The individuals were randomly selected, so we can generalize to the population."
                 ), type = "checkbox")
```


<!-- 1.12. Can we trust the results of your conclusion? Explain your answer, statistically. -->

<!-- > Insert your answer here. -->



